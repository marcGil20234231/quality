import{b as C}from"./chunk-4AEBGA5V.js";import{H as h,J as p,M as c,R as d,k as a,n,v as o}from"./chunk-C2RAPJWX.js";import{a as i,b as u}from"./chunk-2NFLSA4Y.js";var b=class l{constructor(e){this.http=e;console.log("CourseService initialized with API URL:",this.apiUrl)}apiUrl="http://localhost:3000/courses";handleError(e){return console.error("An error occurred:",e),e.status===404?a(()=>new Error("Course not found")):a(()=>new Error("Something went wrong; please try again later."))}getCourses(){return console.log("Fetching all courses from:",this.apiUrl),this.http.get(this.apiUrl).pipe(p(e=>console.log("Fetched courses:",e)),o(this.handleError))}getCourse(e){let r=`${this.apiUrl}/${e}`;return console.log("Fetching course from:",r),this.http.get(r).pipe(p(t=>{if(console.log("Raw course data received:",t),!t)throw new Error("Course not found")}),o(this.handleError))}createCourse(e){let r=u(i({},e),{students:[],createdAt:new Date,updatedAt:new Date});return this.http.post(this.apiUrl,r).pipe(o(this.handleError))}updateCourse(e,r){let t=`${this.apiUrl}/${e}`,s=u(i({},r),{updatedAt:new Date});return this.http.put(t,s).pipe(o(this.handleError))}deleteCourse(e){let r=`${this.apiUrl}/${e}`;return this.http.delete(r).pipe(o(this.handleError))}searchCourses(e){let r=`${this.apiUrl}?q=${e}`;return this.http.get(r).pipe(o(this.handleError))}isUserEnrolled(e,r){return this.getCourse(r).pipe(n(t=>t.students?.includes(e)||!1),o(t=>(console.error("Error checking enrollment:",t),a(()=>t))))}enrollUserInCourse(e,r){return this.getCourse(r).pipe(n(t=>{let s=t.students||[];return s.includes(e)||s.push(e),u(i({},t),{students:s})}),n(t=>this.updateCourse(r,t)),n(()=>{}),o(t=>(console.error("Error enrolling in course:",t),a(()=>t))))}getEnrolledCourses(e){return this.http.get(`/api/courses/enrolled/${e}`)}getRecommendedCourses(e){return this.http.get(`/api/recommended-courses/${e}`)}updateCourseImage(e,r){let t=`${this.apiUrl}/${e}`;return this.getCourse(e).pipe(n(s=>u(i({},s),{imageUrl:r,updatedAt:new Date})),h(s=>this.http.put(t,s)),o(this.handleError))}static \u0275fac=function(r){return new(r||l)(d(C))};static \u0275prov=c({token:l,factory:l.\u0275fac,providedIn:"root"})};export{b as a};
